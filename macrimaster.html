<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MacroMaster Pro - Gerenciador de Macros</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #7c4dff;
            --primary-dark: #6e40e6;
            --primary-light: #9c75ff;
            --secondary: #00bcd4;
            --success: #00c853;
            --warning: #ffab00;
            --danger: #ff5252;
            --dark-bg: #121212;
            --dark-card: #1e1e1e;
            --dark-border: #333333;
            --dark-text: #f5f5f5;
            --dark-text-secondary: #b0b0b0;
            --light-bg: #f8f9fa;
            --light-card: #ffffff;
            --light-border: #e0e0e0;
            --light-text: #212121;
            --light-text-secondary: #757575;
            --border-radius: 12px;
            --transition: all 0.3s ease;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .theme-dark {
            --bg-primary: var(--dark-bg);
            --bg-secondary: var(--dark-card);
            --bg-tertiary: #242424;
            --text-primary: var(--dark-text);
            --text-secondary: var(--dark-text-secondary);
            --border-color: var(--dark-border);
            --card-shadow: var(--shadow);
        }

        .theme-light {
            --bg-primary: var(--light-bg);
            --bg-secondary: var(--light-card);
            --bg-tertiary: #f0f0f0;
            --text-primary: var(--light-text);
            --text-secondary: var(--light-text-secondary);
            --border-color: var(--light-border);
            --card-shadow: var(--shadow-light);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding: 0;
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(124, 77, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 85% 30%, rgba(0, 188, 212, 0.1) 0%, transparent 20%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            font-size: 32px;
            color: var(--primary);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        h1 {
            font-size: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 700;
        }

        .theme-switcher {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--bg-secondary);
            padding: 10px 15px;
            border-radius: 30px;
            box-shadow: var(--card-shadow);
        }

        .theme-btn {
            background: none;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: var(--text-secondary);
        }

        .theme-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 10px rgba(124, 77, 255, 0.3);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
        }

        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: 2;
            }
            
            .macros-section {
                order: 1;
            }
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .form-section, .stats, .categories {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        h2 {
            margin-bottom: 20px;
            font-size: 24px;
            position: relative;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
        }

        h2:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            border-radius: 3px;
        }

        h2 i {
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        label i {
            font-size: 18px;
        }

        input, textarea, select {
            width: 100%;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            transition: var(--transition);
            font-size: 16px;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(124, 77, 255, 0.2);
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 15px rgba(124, 77, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(124, 77, 255, 0.4);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--primary-light);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-sm {
            padding: 8px 15px;
            font-size: 14px;
        }

        .macros-section {
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
        }

        .macros-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-box {
            position: relative;
            flex-grow: 1;
            max-width: 400px;
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .search-box input {
            padding-left: 45px;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 15px;
            border-radius: 30px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: transparent;
        }

        .macros-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .macro-item {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 20px;
            position: relative;
            overflow: hidden;
            border-left: 4px solid var(--primary);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .macro-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .macro-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .macro-title {
            font-weight: 600;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
        }

        .macro-protocol {
            color: var(--primary);
            font-size: 14px;
            font-weight: 500;
            background: rgba(124, 77, 255, 0.1);
            padding: 5px 10px;
            border-radius: 20px;
        }

        .macro-content {
            margin-bottom: 15px;
            white-space: pre-wrap;
            line-height: 1.5;
            color: var(--text-secondary);
            flex-grow: 1;
            max-height: 150px;
            overflow: hidden;
            position: relative;
        }

        .macro-content.expanded {
            max-height: none;
        }

        .read-more {
            position: absolute;
            bottom: 0;
            right: 0;
            background: linear-gradient(to right, transparent, var(--bg-secondary) 50%);
            padding-left: 20px;
            color: var(--primary);
            cursor: pointer;
            font-size: 12px;
            padding: 2px 5px;
        }

        .macro-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }

        .macro-date {
            color: var(--text-secondary);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .macro-actions {
            display: flex;
            gap: 10px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 0;
            color: var(--text-secondary);
            grid-column: 1 / -1;
        }

        .empty-state i {
            font-size: 50px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: linear-gradient(135deg, var(--danger), #d32f2f);
        }

        .notification.warning {
            background: linear-gradient(135deg, var(--warning), #f57c00);
        }

        .tag {
            display: inline-flex;
            align-items: center;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            gap: 5px;
        }

        .tag-atendimento {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
        }

        .tag-evidencia {
            background: linear-gradient(to right, var(--success), #00b248);
            color: white;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-card {
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: var(--border-radius);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            box-shadow: var(--card-shadow);
        }

        .stat-card i {
            font-size: 28px;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .copy-btn {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 8px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .copy-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .categories {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .category-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            background: var(--bg-tertiary);
            cursor: pointer;
            transition: var(--transition);
        }

        .category-item:hover, .category-item.active {
            background: var(--primary);
            color: white;
        }

        .category-item i {
            font-size: 18px;
        }

        .category-count {
            margin-left: auto;
            background: var(--bg-primary);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            padding: 30px;
            width: 90%;
            max-width: 600px;
            box-shadow: var(--shadow);
            position: relative;
            animation: modalFadeIn 0.3s ease;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .export-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .export-btn {
            padding: 12px 20px;
            border-radius: var(--border-radius);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .export-btn:hover {
            background: var(--primary);
            color: white;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .pagination-btn {
            padding: 8px 15px;
            border-radius: var(--border-radius);
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
        }

        .pagination-btn.active {
            background: var(--primary);
            color: white;
        }

        .pagination-btn:hover:not(.active) {
            background: var(--primary-light);
            color: white;
        }

        .form-actions {
            display: flex;
            gap: 10px;
        }

        #cancelEdit {
            display: none;
        }

        .confirm-modal .modal-content {
            max-width: 450px;
            text-align: center;
        }

        .confirm-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .advanced-search {
            margin-top: 15px;
            padding: 15px;
            background: var(--bg-tertiary);
            border-radius: var(--border-radius);
            display: none;
        }

        .advanced-search.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .search-toggle {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }

        /* Novos estilos para upload de imagens */
        .image-upload {
            margin-bottom: 20px;
        }

        .image-upload-label {
            display: block;
            padding: 15px;
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .image-upload-label:hover {
            border-color: var(--primary);
            background-color: var(--bg-tertiary);
        }

        .image-upload-label i {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .image-preview {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }

        .preview-item img {
            width: 100%;
            height: 80px;
            object-fit: cover;
            display: block;
        }

        .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .macro-images {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 10px 0;
        }

        .macro-image {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }

        .macro-image img {
            width: 100%;
            height: 100px;
            object-fit: cover;
        }

        .copy-with-images {
            margin-top: 10px;
            background: linear-gradient(135deg, var(--secondary), var(--primary-dark));
        }

        @media (max-width: 768px) {
            .macros-list {
                grid-template-columns: 1fr;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .macro-footer {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .macro-actions {
                width: 100%;
                justify-content: space-between;
            }

            .macros-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .search-box {
                max-width: 100%;
            }

            .image-preview, .macro-images {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .image-preview, .macro-images {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="theme-dark">
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon"><i class="fas fa-code-branch"></i></div>
                <h1>MacroMaster Pro</h1>
            </div>
            <div class="theme-switcher">
                <button class="theme-btn active" id="themeDark" title="Tema Escuro">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="theme-btn" id="themeLight" title="Tema Claro">
                    <i class="fas fa-sun"></i>
                </button>
            </div>
        </header>

        <div class="main-content">
            <div class="sidebar">
                <div class="stats">
                    <div class="stat-card">
                        <i class="fas fa-clipboard-list"></i>
                        <div class="stat-number" id="totalMacros">0</div>
                        <div class="stat-label">Total de Macros</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-headset"></i>
                        <div class="stat-number" id="atendimentoCount">0</div>
                        <div class="stat-label">Macros de Atendimento</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-clipboard-check"></i>
                        <div class="stat-number" id="evidenciaCount">0</div>
                        <div class="stat-label">Evidências</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-database"></i>
                        <div class="stat-number" id="storageUsage">0KB</div>
                        <div class="stat-label">Uso de Armazenamento</div>
                    </div>
                </div>

                <section class="form-section">
                    <h2><i class="fas fa-plus-circle"></i> <span id="formTitle">Nova Macro</span></h2>
                    <form id="macroForm">
                        <input type="hidden" id="editId" value="">
                        <div class="form-group">
                            <label for="macroTitle"><i class="fas fa-heading"></i> Título</label>
                            <input type="text" id="macroTitle" required placeholder="Ex: Problema com conexão">
                        </div>
                        <div class="form-group">
                            <label for="macroProtocol"><i class="fas fa-hashtag"></i> Protocolo</label>
                            <input type="text" id="macroProtocol" required placeholder="Ex: PROTOCOLO-123">
                        </div>
                        <div class="form-group">
                            <label for="macroType"><i class="fas fa-tag"></i> Tipo</label>
                            <select id="macroType" required>
                                <option value="">Selecione o tipo</option>
                                <option value="atendimento">Macro de Atendimento</option>
                                <option value="evidencia">Evidência</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="macroContent"><i class="fas fa-align-left"></i> Conteúdo</label>
                            <textarea id="macroContent" required placeholder="Digite o conteúdo da macro..."></textarea>
                        </div>
                        <div class="form-group image-upload">
                            <label><i class="fas fa-images"></i> Imagens (opcional)</label>
                            <label for="macroImages" class="image-upload-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Clique para adicionar imagens ou arraste-as aqui</p>
                                <small>Máx. 5 imagens • JPG, PNG ou GIF</small>
                            </label>
                            <input type="file" id="macroImages" accept="image/*" multiple style="display: none;">
                            <div class="image-preview" id="imagePreview"></div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i> <span id="submitText">Salvar Macro</span>
                            </button>
                            <button type="button" class="btn btn-secondary" id="cancelEdit">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                        </div>
                    </form>
                </section>

                <div class="categories">
                    <h2><i class="fas fa-folder"></i> Categorias</h2>
                    <div class="category-item active" data-category="all">
                        <i class="fas fa-layer-group"></i>
                        <span>Todas as Macros</span>
                        <span class="category-count" id="countAll">0</span>
                    </div>
                    <div class="category-item" data-category="atendimento">
                        <i class="fas fa-headset"></i>
                        <span>Macros de Atendimento</span>
                        <span class="category-count" id="countAtendimento">0</span>
                    </div>
                    <div class="category-item" data-category="evidencia">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Evidências</span>
                        <span class="category-count" id="countEvidencia">0</span>
                    </div>
                    <div class="category-item" data-category="favoritas">
                        <i class="fas fa-star"></i>
                        <span>Favoritos</span>
                        <span class="category-count" id="countFavoritas">0</span>
                    </div>
                    <div class="category-item" data-category="recentes">
                        <i class="fas fa-history"></i>
                        <span>Recentes</span>
                    </div>
                </div>
            </div>

            <section class="macros-section">
                <div class="macros-header">
                    <h2><i class="fas fa-list"></i> Macros Salvas</h2>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="Buscar por título, protocolo ou conteúdo...">
                        <button class="search-toggle" id="toggleAdvancedSearch">
                            <i class="fas fa-cog"></i> Busca Avançada
                        </button>
                        <div class="advanced-search" id="advancedSearch">
                            <div class="form-group">
                                <label for="searchType"><i class="fas fa-filter"></i> Filtrar por Tipo</label>
                                <select id="searchType">
                                    <option value="">Todos os tipos</option>
                                    <option value="atendimento">Atendimento</option>
                                    <option value="evidencia">Evidência</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="searchDate"><i class="fas fa-calendar"></i> Filtrar por Data</label>
                                <select id="searchDate">
                                    <option value="">Qualquer data</option>
                                    <option value="today">Hoje</option>
                                    <option value="week">Esta semana</option>
                                    <option value="month">Este mês</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <button class="filter-btn active" data-filter="all">
                            <i class="fas fa-layer-group"></i> Todas
                        </button>
                        <button class="filter-btn" data-filter="atendimento">
                            <i class="fas fa-headset"></i> Atendimento
                        </button>
                        <button class="filter-btn" data-filter="evidencia">
                            <i class="fas fa-clipboard-check"></i> Evidências
                        </button>
                        <button class="btn-outline" id="exportBtn">
                            <i class="fas fa-file-export"></i> Exportar
                        </button>
                    </div>
                </div>
                <div class="macros-list" id="macrosList">
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <p>Nenhuma macro cadastrada ainda.</p>
                        <p>Use o formulário ao lado para criar sua primeira macro.</p>
                    </div>
                </div>
                <div class="pagination" id="pagination"></div>
            </section>
        </div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span>Macro salva com sucesso!</span>
    </div>

    <div class="modal" id="exportModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h2><i class="fas fa-file-export"></i> Exportar Macros</h2>
            <p>Selecione o formato para exportar suas macros:</p>
            <div class="export-options">
                <button class="export-btn" id="exportJSON">
                    <i class="fas fa-file-code"></i> Exportar como JSON
                </button>
                <button class="export-btn" id="exportCSV">
                    <i class="fas fa-file-csv"></i> Exportar como CSV
                </button>
                <button class="export-btn" id="exportTXT">
                    <i class="fas fa-file-alt"></i> Exportar como Texto
                </button>
            </div>
        </div>
    </div>

    <div class="modal confirm-modal" id="confirmModal">
        <div class="modal-content">
            <span class="close-modal" id="closeConfirmModal">&times;</span>
            <h2><i class="fas fa-exclamation-triangle"></i> Confirmar Exclusão</h2>
            <p>Tem certeza que deseja excluir esta macro? Esta ação não pode ser desfeita.</p>
            <div class="confirm-actions">
                <button class="btn btn-secondary" id="cancelDelete">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button class="btn btn-danger" id="confirmDelete">
                    <i class="fas fa-trash"></i> Excluir
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos DOM
            const macroForm = document.getElementById('macroForm');
            const macrosList = document.getElementById('macrosList');
            const searchInput = document.getElementById('searchInput');
            const notification = document.getElementById('notification');
            const themeDark = document.getElementById('themeDark');
            const themeLight = document.getElementById('themeLight');
            const totalMacros = document.getElementById('totalMacros');
            const atendimentoCount = document.getElementById('atendimentoCount');
            const evidenciaCount = document.getElementById('evidenciaCount');
            const storageUsage = document.getElementById('storageUsage');
            const exportBtn = document.getElementById('exportBtn');
            const exportModal = document.getElementById('exportModal');
            const closeModal = document.getElementById('closeModal');
            const exportJSON = document.getElementById('exportJSON');
            const exportCSV = document.getElementById('exportCSV');
            const exportTXT = document.getElementById('exportTXT');
            const filterButtons = document.querySelectorAll('.filter-btn');
            const categoryItems = document.querySelectorAll('.category-item');
            const pagination = document.getElementById('pagination');
            const formTitle = document.getElementById('formTitle');
            const submitText = document.getElementById('submitText');
            const cancelEdit = document.getElementById('cancelEdit');
            const editId = document.getElementById('editId');
            const confirmModal = document.getElementById('confirmModal');
            const closeConfirmModal = document.getElementById('closeConfirmModal');
            const cancelDelete = document.getElementById('cancelDelete');
            const confirmDelete = document.getElementById('confirmDelete');
            const toggleAdvancedSearch = document.getElementById('toggleAdvancedSearch');
            const advancedSearch = document.getElementById('advancedSearch');
            const searchType = document.getElementById('searchType');
            const searchDate = document.getElementById('searchDate');
            const macroImages = document.getElementById('macroImages');
            const imagePreview = document.getElementById('imagePreview');
            
            // Contadores de categorias
            const countAll = document.getElementById('countAll');
            const countAtendimento = document.getElementById('countAtendimento');
            const countEvidencia = document.getElementById('countEvidencia');
            const countFavoritas = document.getElementById('countFavoritas');
            
            // Variáveis de estado
            let macros = JSON.parse(localStorage.getItem('macros')) || [];
            let currentFilter = 'all';
            let currentCategory = 'all';
            let currentPage = 1;
            const itemsPerPage = 6;
            let macroToDelete = null;
            let uploadedImages = [];
            
            // Inicialização
            renderMacros();
            updateStats();
            updateCategoryCounts();
            
            // Configurar upload de imagens
            macroImages.addEventListener('change', handleImageUpload);
            
            // Adicionar/Editar macro
            macroForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const title = document.getElementById('macroTitle').value;
                const protocol = document.getElementById('macroProtocol').value;
                const type = document.getElementById('macroType').value;
                const content = document.getElementById('macroContent').value;
                const id = editId.value;
                
                if (id) {
                    // Modo edição
                    const index = macros.findIndex(m => m.id == id);
                    if (index !== -1) {
                        macros[index] = {
                            ...macros[index],
                            title,
                            protocol,
                            type,
                            content,
                            images: uploadedImages.length > 0 ? uploadedImages : macros[index].images,
                            date: new Date().toLocaleString('pt-BR')
                        };
                        showNotification('Macro atualizada com sucesso!');
                    }
                } else {
                    // Modo criação
                    const newMacro = {
                        id: Date.now(),
                        title,
                        protocol,
                        type,
                        content,
                        images: [...uploadedImages],
                        date: new Date().toLocaleString('pt-BR'),
                        favorite: false
                    };
                    
                    macros.push(newMacro);
                    showNotification('Macro salva com sucesso!');
                }
                
                saveMacros();
                renderMacros();
                updateStats();
                updateCategoryCounts();
                resetForm();
            });
            
            // Cancelar edição
            cancelEdit.addEventListener('click', resetForm);
            
            // Buscar macros
            searchInput.addEventListener('input', function() {
                currentPage = 1;
                renderMacros();
            });
            
            // Filtros avançados
            searchType.addEventListener('change', function() {
                currentPage = 1;
                renderMacros();
            });
            
            searchDate.addEventListener('change', function() {
                currentPage = 1;
                renderMacros();
            });
            
            // Alternar busca avançada
            toggleAdvancedSearch.addEventListener('click', function() {
                advancedSearch.classList.toggle('show');
            });
            
            // Filtrar por tipo
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    currentPage = 1;
                    renderMacros();
                });
            });
            
            // Filtrar por categoria
            categoryItems.forEach(item => {
                item.addEventListener('click', function() {
                    categoryItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    currentPage = 1;
                    renderMacros();
                });
            });
            
            // Alternar tema
            themeDark.addEventListener('click', function() {
                document.body.className = 'theme-dark';
                themeDark.classList.add('active');
                themeLight.classList.remove('active');
            });
            
            themeLight.addEventListener('click', function() {
                document.body.className = 'theme-light';
                themeLight.classList.add('active');
                themeDark.classList.remove('active');
            });
            
            // Exportar macros
            exportBtn.addEventListener('click', function() {
                exportModal.style.display = 'flex';
            });
            
            closeModal.addEventListener('click', function() {
                exportModal.style.display = 'none';
            });
            
            exportJSON.addEventListener('click', function() {
                exportMacros('json');
            });
            
            exportCSV.addEventListener('click', function() {
                exportMacros('csv');
            });
            
            exportTXT.addEventListener('click', function() {
                exportMacros('txt');
            });
            
            // Modal de confirmação de exclusão
            closeConfirmModal.addEventListener('click', function() {
                confirmModal.style.display = 'none';
            });
            
            cancelDelete.addEventListener('click', function() {
                confirmModal.style.display = 'none';
            });
            
            confirmDelete.addEventListener('click', function() {
                if (macroToDelete) {
                    deleteMacro(macroToDelete);
                    macroToDelete = null;
                }
                confirmModal.style.display = 'none';
            });
            
            // Funções auxiliares
            function handleImageUpload(e) {
                const files = e.target.files;
                if (!files || files.length === 0) return;
                
                // Limitar a 5 imagens
                if (uploadedImages.length + files.length > 5) {
                    showNotification('Máximo de 5 imagens permitidas!', 'error');
                    return;
                }
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    
                    // Verificar se é uma imagem
                    if (!file.type.match('image.*')) {
                        showNotification('Apenas arquivos de imagem são permitidos!', 'error');
                        continue;
                    }
                    
                    // Verificar tamanho do arquivo (máx. 2MB)
                    if (file.size > 2 * 1024 * 1024) {
                        showNotification('Imagem muito grande! Máximo de 2MB por imagem.', 'error');
                        continue;
                    }
                    
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const imageData = {
                            name: file.name,
                            data: e.target.result,
                            type: file.type
                        };
                        
                        uploadedImages.push(imageData);
                        renderImagePreview();
                    };
                    
                    reader.readAsDataURL(file);
                }
                
                // Resetar o input para permitir adicionar as mesmas imagens novamente
                macroImages.value = '';
            }
            
            function renderImagePreview() {
                imagePreview.innerHTML = '';
                
                uploadedImages.forEach((image, index) => {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    previewItem.innerHTML = `
                        <img src="${image.data}" alt="${image.name}">
                        <button type="button" class="remove-image" data-index="${index}">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    imagePreview.appendChild(previewItem);
                });
                
                // Adicionar eventos para remover imagens
                document.querySelectorAll('.remove-image').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        uploadedImages.splice(index, 1);
                        renderImagePreview();
                    });
                });
            }
            
            function renderMacros() {
                let filteredMacros = filterMacros();
                
                // Paginação
                const totalPages = Math.ceil(filteredMacros.length / itemsPerPage);
                const startIndex = (currentPage - 1) * itemsPerPage;
                const paginatedMacros = filteredMacros.slice(startIndex, startIndex + itemsPerPage);
                
                // Limpar lista
                macrosList.innerHTML = '';
                
                if (paginatedMacros.length === 0) {
                    macrosList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-search"></i>
                            <p>Nenhuma macro encontrada.</p>
                            <p>Tente ajustar os filtros ou termos de busca.</p>
                        </div>
                    `;
                    pagination.innerHTML = '';
                    return;
                }
                
                // Renderizar macros
                paginatedMacros.forEach(macro => {
                    const isLongContent = macro.content.length > 200;
                    const shortContent = isLongContent ? macro.content.substring(0, 200) + '...' : macro.content;
                    
                    const macroItem = document.createElement('div');
                    macroItem.className = 'macro-item';
                    
                    // Construir HTML das imagens se existirem
                    let imagesHTML = '';
                    if (macro.images && macro.images.length > 0) {
                        imagesHTML = '<div class="macro-images">';
                        macro.images.forEach(img => {
                            imagesHTML += `
                                <div class="macro-image">
                                    <img src="${img.data}" alt="${img.name}">
                                </div>
                            `;
                        });
                        imagesHTML += '</div>';
                    }
                    
                    macroItem.innerHTML = `
                        <div class="macro-header">
                            <div class="macro-title">
                                <span>${macro.title}</span>
                                <span class="macro-protocol">${macro.protocol}</span>
                            </div>
                            <span class="tag tag-${macro.type}">
                                <i class="fas ${macro.type === 'atendimento' ? 'fa-headset' : 'fa-clipboard-check'}"></i>
                                ${macro.type === 'atendimento' ? 'Atendimento' : 'Evidência'}
                            </span>
                        </div>
                        ${imagesHTML}
                        <div class="macro-content">
                            ${shortContent}
                            ${isLongContent ? '<span class="read-more">Ver mais</span>' : ''}
                        </div>
                        <div class="macro-footer">
                            <div class="macro-date">
                                <i class="fas fa-calendar"></i> ${macro.date}
                            </div>
                            <div class="macro-actions">
                                <button class="copy-btn" data-id="${macro.id}">
                                    <i class="fas fa-copy"></i> Copiar
                                </button>
                                ${macro.images && macro.images.length > 0 ? `
                                    <button class="copy-btn copy-with-images" data-id="${macro.id}">
                                        <i class="fas fa-copy"></i> Copiar com Imagens
                                    </button>
                                ` : ''}
                                <button class="btn btn-sm btn-secondary edit-macro" data-id="${macro.id}">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button class="btn btn-sm btn-danger delete-macro" data-id="${macro.id}">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                                <button class="btn btn-sm ${macro.favorite ? 'btn-primary' : 'btn-secondary'} favorite-macro" data-id="${macro.id}">
                                    <i class="fas ${macro.favorite ? 'fa-star' : 'fa-star'}"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    
                    macrosList.appendChild(macroItem);
                    
                    // Evento para expandir/contrair conteúdo
                    if (isLongContent) {
                        const contentElement = macroItem.querySelector('.macro-content');
                        const readMoreBtn = macroItem.querySelector('.read-more');
                        
                        if (readMoreBtn) {
                            readMoreBtn.addEventListener('click', function() {
                                contentElement.classList.toggle('expanded');
                                readMoreBtn.textContent = contentElement.classList.contains('expanded') ? 'Ver menos' : 'Ver mais';
                            });
                        }
                    }
                    
                    // Eventos para os botões
                    macroItem.querySelector('.copy-btn').addEventListener('click', function() {
                        copyToClipboard(macro.content);
                        showNotification('Conteúdo copiado para a área de transferência!');
                    });
                    
                    // Evento para copiar com imagens
                    const copyWithImagesBtn = macroItem.querySelector('.copy-with-images');
                    if (copyWithImagesBtn) {
                        copyWithImagesBtn.addEventListener('click', function() {
                            copyMacroWithImages(macro);
                            showNotification('Conteúdo e imagens copiados para a área de transferência!');
                        });
                    }
                    
                    macroItem.querySelector('.edit-macro').addEventListener('click', function() {
                        editMacro(macro.id);
                    });
                    
                    macroItem.querySelector('.delete-macro').addEventListener('click', function() {
                        macroToDelete = macro.id;
                        confirmModal.style.display = 'flex';
                    });
                    
                    macroItem.querySelector('.favorite-macro').addEventListener('click', function() {
                        toggleFavorite(macro.id);
                    });
                });
                
                // Renderizar paginação
                renderPagination(totalPages);
            }
            
            function copyMacroWithImages(macro) {
                // Criar texto formatado com URLs das imagens
                let textWithImages = macro.content;
                
                if (macro.images && macro.images.length > 0) {
                    textWithImages += '\n\n--- IMAGENS ---\n';
                    macro.images.forEach(img => {
                        textWithImages += `\n[${img.name}] ${img.data}\n`;
                    });
                }
                
                copyToClipboard(textWithImages);
            }
            
            function renderPagination(totalPages) {
                pagination.innerHTML = '';
                
                if (totalPages <= 1) return;
                
                // Botão Anterior
                const prevBtn = document.createElement('button');
                prevBtn.className = 'pagination-btn';
                prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                prevBtn.disabled = currentPage === 1;
                prevBtn.addEventListener('click', () => {
                    if (currentPage > 1) {
                        currentPage--;
                        renderMacros();
                    }
                });
                pagination.appendChild(prevBtn);
                
                // Páginas
                for (let i = 1; i <= totalPages; i++) {
                    const pageBtn = document.createElement('button');
                    pageBtn.className = `pagination-btn ${i === currentPage ? 'active' : ''}`;
                    pageBtn.textContent = i;
                    pageBtn.addEventListener('click', () => {
                        currentPage = i;
                        renderMacros();
                    });
                    pagination.appendChild(pageBtn);
                }
                
                // Botão Próximo
                const nextBtn = document.createElement('button');
                    nextBtn.className = 'pagination-btn';
                    nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                    nextBtn.disabled = currentPage === totalPages;
                    nextBtn.addEventListener('click', () => {
                        if (currentPage < totalPages) {
                            currentPage++;
                            renderMacros();
                        }
                    });
                    pagination.appendChild(nextBtn);
                }
                
                function filterMacros() {
                    let filtered = [...macros];
                    
                    // Aplicar filtro de categoria
                    if (currentCategory !== 'all') {
                        if (currentCategory === 'favoritas') {
                            filtered = filtered.filter(m => m.favorite);
                        } else if (currentCategory === 'recentes') {
                            const oneWeekAgo = new Date();
                            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                            filtered = filtered.filter(m => {
                                const macroDate = new Date(m.date);
                                return macroDate >= oneWeekAgo;
                            });
                        } else {
                            filtered = filtered.filter(m => m.type === currentCategory);
                        }
                    }
                    
                    // Aplicar filtro de tipo
                    if (currentFilter !== 'all') {
                        filtered = filtered.filter(m => m.type === currentFilter);
                    }
                    
                    // Aplicar busca
                    const searchTerm = searchInput.value.toLowerCase();
                    if (searchTerm) {
                        filtered = filtered.filter(m => 
                            m.title.toLowerCase().includes(searchTerm) ||
                            m.protocol.toLowerCase().includes(searchTerm) ||
                            m.content.toLowerCase().includes(searchTerm)
                        );
                    }
                    
                    // Aplicar filtro de tipo (busca avançada)
                    const typeFilter = searchType.value;
                    if (typeFilter) {
                        filtered = filtered.filter(m => m.type === typeFilter);
                    }
                    
                    // Aplicar filtro de data (busca avançada)
                    const dateFilter = searchDate.value;
                    if (dateFilter) {
                        const now = new Date();
                        filtered = filtered.filter(m => {
                            const macroDate = new Date(m.date);
                            
                            switch(dateFilter) {
                                case 'today':
                                    return macroDate.toDateString() === now.toDateString();
                                case 'week':
                                    const oneWeekAgo = new Date();
                                    oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                                    return macroDate >= oneWeekAgo;
                                case 'month':
                                    const oneMonthAgo = new Date();
                                    oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
                                    return macroDate >= oneMonthAgo;
                                default:
                                    return true;
                            }
                        });
                    }
                    
                    return filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
                }
                
                function editMacro(id) {
                    const macro = macros.find(m => m.id == id);
                    if (macro) {
                        document.getElementById('macroTitle').value = macro.title;
                        document.getElementById('macroProtocol').value = macro.protocol;
                        document.getElementById('macroType').value = macro.type;
                        document.getElementById('macroContent').value = macro.content;
                        editId.value = macro.id;
                        
                        // Carregar imagens da macro para edição
                        uploadedImages = macro.images ? [...macro.images] : [];
                        renderImagePreview();
                        
                        formTitle.textContent = 'Editar Macro';
                        submitText.textContent = 'Atualizar Macro';
                        cancelEdit.style.display = 'inline-flex';
                        
                        // Scroll para o formulário
                        document.querySelector('.form-section').scrollIntoView({ behavior: 'smooth' });
                    }
                }
                
                function deleteMacro(id) {
                    macros = macros.filter(m => m.id != id);
                    saveMacros();
                    renderMacros();
                    updateStats();
                    updateCategoryCounts();
                    showNotification('Macro excluída com sucesso!', 'warning');
                }
                
                function toggleFavorite(id) {
                    const index = macros.findIndex(m => m.id == id);
                    if (index !== -1) {
                        macros[index].favorite = !macros[index].favorite;
                        saveMacros();
                        renderMacros();
                        updateCategoryCounts();
                        showNotification(macros[index].favorite ? 'Macro adicionada aos favoritos!' : 'Macro removida dos favoritos!');
                    }
                }
                
                function resetForm() {
                    macroForm.reset();
                    editId.value = '';
                    uploadedImages = [];
                    imagePreview.innerHTML = '';
                    formTitle.textContent = 'Nova Macro';
                    submitText.textContent = 'Salvar Macro';
                    cancelEdit.style.display = 'none';
                }
                
                function saveMacros() {
                    localStorage.setItem('macros', JSON.stringify(macros));
                    updateStorageUsage();
                }
                
                function updateStats() {
                    totalMacros.textContent = macros.length;
                    atendimentoCount.textContent = macros.filter(m => m.type === 'atendimento').length;
                    evidenciaCount.textContent = macros.filter(m => m.type === 'evidencia').length;
                }
                
                function updateCategoryCounts() {
                    countAll.textContent = macros.length;
                    countAtendimento.textContent = macros.filter(m => m.type === 'atendimento').length;
                    countEvidencia.textContent = macros.filter(m => m.type === 'evidencia').length;
                    countFavoritas.textContent = macros.filter(m => m.favorite).length;
                }
                
                function updateStorageUsage() {
                    const data = localStorage.getItem('macros') || '';
                    const sizeInKB = (new Blob([data]).size / 1024).toFixed(2);
                    storageUsage.textContent = `${sizeInKB} KB`;
                }
                
                function showNotification(message, type = 'success') {
                    const icon = type === 'success' ? 'fa-check-circle' : 
                                type === 'warning' ? 'fa-exclamation-circle' : 'fa-info-circle';
                    
                    notification.innerHTML = `<i class="fas ${icon}"></i> <span>${message}</span>`;
                    notification.className = `notification ${type} show`;
                    
                    setTimeout(() => {
                        notification.classList.remove('show');
                    }, 3000);
                }
                
                function copyToClipboard(text) {
                    navigator.clipboard.writeText(text).catch(err => {
                        console.error('Erro ao copiar texto: ', err);
                        // Fallback para navegadores mais antigos
                        const textArea = document.createElement('textarea');
                        textArea.value = text;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                    });
                }
                
                function exportMacros(format) {
                    let data, mimeType, fileName, blob;
                    
                    switch(format) {
                        case 'json':
                            data = JSON.stringify(macros, null, 2);
                            mimeType = 'application/json';
                            fileName = 'macros.json';
                            break;
                        case 'csv':
                            data = 'Título,Protocolo,Tipo,Data,Conteúdo\n';
                            macros.forEach(m => {
                                data += `"${m.title}","${m.protocol}","${m.type}","${m.date}","${m.content.replace(/"/g, '""')}"\n`;
                            });
                            mimeType = 'text/csv';
                            fileName = 'macros.csv';
                            break;
                        case 'txt':
                            data = '';
                            macros.forEach(m => {
                                data += `Título: ${m.title}\n`;
                                data += `Protocolo: ${m.protocol}\n`;
                                data += `Tipo: ${m.type}\n`;
                                data += `Data: ${m.date}\n`;
                                data += `Conteúdo:\n${m.content}\n\n`;
                                data += '----------------------------------------\n\n';
                            });
                            mimeType = 'text/plain';
                            fileName = 'macros.txt';
                            break;
                    }
                    
                    blob = new Blob([data], { type: mimeType });
                    const url = URL.createObjectURL(blob);
                    
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = fileName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    exportModal.style.display = 'none';
                    showNotification(`Macros exportadas como ${format.toUpperCase()} com sucesso!`);
                }
                
                // Fechar modais ao clicar fora deles
                window.addEventListener('click', function(e) {
                    if (e.target === exportModal) {
                        exportModal.style.display = 'none';
                    }
                    if (e.target === confirmModal) {
                        confirmModal.style.display = 'none';
                    }
                });
            });
        </script>
</body>
</html>